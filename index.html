<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NatureNow</title>
    
    <!-- PWA Meta Tags -->
    <meta name="description" content="Daily messages about the natural world and climate change impacts">
    <meta name="theme-color" content="#667eea">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="NatureNow">
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Georgia', serif;
            background: linear-gradient(135deg, #4a7c59 0%, #2d5a3d 100%);
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #333;
            line-height: 1.6;
            overflow-x: hidden;
        }

        .container {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 40px;
            max-width: 600px;
            width: 90%;
            margin: 20px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            backdrop-filter: blur(10px);
            text-align: center;
            transition: transform 0.3s ease;
            position: relative;
            overflow: hidden;
            touch-action: pan-y;
        }

        .container:hover {
            transform: translateY(-5px);
        }

        .date {
            font-size: 18px;
            color: #666;
            margin-bottom: 30px;
            font-weight: 300;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .message {
            font-size: 24px;
            color: #2c3e50;
            margin-bottom: 20px;
            font-weight: 400;
            animation: fadeIn 1s ease-in;
            line-height: 1.4;
        }

        .message a {
            color: #2980b9;
            font-weight: 500;
            text-decoration: underline;
            transition: color 0.3s ease;
        }

        .message a:hover {
            color: #1a5490;
        }

        .phenology-info {
            font-size: 16px;
            color: #7f8c8d;
            background: rgba(52, 152, 219, 0.1);
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 30px;
            animation: slideIn 1s ease-in 0.3s both;
            text-align: left;
        }

        .phenology-label {
            font-weight: 600;
            color: #2980b9;
            display: block;
            margin-bottom: 5px;
            font-size: 14px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            text-align: center;
        }

        .navigation {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 20px;
            gap: 15px;
        }

        .nav-btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 15px;
            font-size: 14px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-family: inherit;
            min-width: 80px;
            font-weight: 500;
        }

        .nav-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.2);
        }

        .nav-btn:active {
            transform: translateY(0);
        }

        .nav-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        .loading {
            opacity: 0.6;
            animation: pulse 1.5s infinite;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        @keyframes slideIn {
            from { opacity: 0; transform: translateX(-20px); }
            to { opacity: 1; transform: translateX(0); }
        }

        @keyframes pulse {
            0%, 100% { opacity: 0.6; }
            50% { opacity: 1; }
        }

        .swipe-hint {
            position: absolute;
            bottom: -30px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 12px;
            color: rgba(255, 255, 255, 0.7);
            animation: fadeIn 2s ease-in 1s both;
        }

        @media (max-width: 768px) {
            .container {
                padding: 30px 25px;
                margin: 15px;
                width: 95%;
            }
            
            .message {
                font-size: 22px;
            }

            .phenology-info {
                font-size: 15px;
                padding: 12px;
            }
        }

        @media (max-width: 480px) {
            .container {
                padding: 25px 20px;
                margin: 10px;
            }
            
            .message {
                font-size: 20px;
            }

            .navigation {
                gap: 10px;
            }

            .nav-btn {
                padding: 10px 16px;
                font-size: 13px;
                min-width: 70px;
            }

            .phenology-info {
                font-size: 14px;
            }
        }
    </style>
</head>
<body>
    <div class="container" id="mainContainer">
        <div class="date" id="currentDate">Loading...</div>
        <div class="message loading" id="dailyMessage">Loading your daily nature message...</div>
        <div class="phenology-info loading" id="phenologyInfo">
            <span class="phenology-label">Impacts of a warming climate</span>
            Loading phenology information...
        </div>
        
        <div class="navigation">
            <button class="nav-btn" id="prevBtn" onclick="previousMessage()">← Previous</button>
            <button class="nav-btn" id="nextBtn" onclick="nextMessage()">Next →</button>
        </div>
        
        <div class="swipe-hint">Swipe or use arrow keys to navigate</div>
    </div>

    <!-- DATA SECTION - Keep all content here for easy management -->
    <script>
        // ==========================================================================
        // DATA SECTION - Edit this section to update content
        // ==========================================================================
        const NATURE_DATA = {
            messages: [
                {
                    date: "22nd August",
                    message: "Blackberries ripen in hedgerows, their dark juice staining fingers",
                    phenology: "Blackberry ripening occurs 1-2 weeks earlier than in the 1980s, with extended fruiting seasons providing food over longer periods.",
                    species: ["blackberries"]
                },
                {
                    date: "23rd August", 
                    message: "Swallows gather on telegraph wires, preparing for their epic journey south",
                    phenology: "Swallow departure timing remains relatively stable, but breeding seasons now extend later, with some attempting third broods.",
                    species: ["swallows"]
                },
                {
                    date: "24th August",
                    message: "Rowan berries glow orange-red in mountain woods", 
                    phenology: "Rowan fruiting has advanced by 10-12 days, affecting the timing of autumn bird migrations that depend on these berries.",
                    species: ["rowan berries"]
                },
                {
                    date: "25th August",
                    message: "Young starlings form chattering flocks in suburban parks",
                    phenology: "Starling flock formation occurs earlier as breeding seasons extend, but flock sizes are smaller due to overall population declines.",
                    species: ["starlings"]
                },
                {
                    date: "26th August",
                    message: "Common darters patrol garden ponds in the late summer heat",
                    phenology: "Dragonfly activity periods have extended by 2-3 weeks, with some species now active well into October.",
                    species: ["common darters"]
                },
                {
                    date: "27th August",
                    message: "Wild clematis adorns hedges with fluffy seed heads like old man's beard",
                    phenology: "Clematis seed dispersal timing has shifted later, extending into autumn and changing winter hedgerow appearance.",
                    species: ["wild clematis"]
                },
                {
                    date: "28th August",
                    message: "Migrant hawker dragonflies hunt over heathland pools",
                    phenology: "Hawker dragonflies now emerge 2-3 weeks earlier and remain active longer, overlapping with species not historically sympatric.",
                    species: ["migrant hawker dragonflies"]
                },
                {
                    date: "29th August",
                    message: "House martins gather mud for their late broods under the eaves",
                    phenology: "House martins attempt later broods more frequently, but face challenges from reduced insect availability in late summer.",
                    species: ["house martins"]
                },
                {
                    date: "30th August",
                    message: "Hazel nuts ripen green and milky in their leafy cups",
                    phenology: "Hazel nut ripening has advanced 7-10 days, sometimes occurring before squirrels have finished with their earlier food sources.",
                    species: ["hazel nuts"]
                },
                {
                    date: "31st August",
                    message: "Painted lady butterflies continue their endless migration across gardens",
                    phenology: "Painted lady migrations are becoming more unpredictable, with some populations overwintering in southern Britain.",
                    species: ["painted lady butterflies"]
                },
                {
                    date: "1st September",
                    message: "Speckled wood butterflies dance in dappled woodland clearings",
                    phenology: "Speckled woods now produce an additional generation in warmer years, extending their flight period into November.",
                    species: ["speckled wood butterflies"]
                },
                {
                    date: "2nd September",
                    message: "Fieldfares arrive from Scandinavia with harsh chattering calls",
                    phenology: "Fieldfare arrival has delayed by 2-3 weeks as northern European autumns warm, shortening their British residence.",
                    species: ["fieldfares"]
                },
                {
                    date: "3rd September",
                    message: "Elderberries hang in heavy purple clusters",
                    phenology: "Elder fruiting occurs 10-14 days earlier, with extended seasons but sometimes reduced berry quality in drought years.",
                    species: ["elderberries"]
                },
                {
                    date: "4th September",
                    message: "Red admiral butterflies feast on buddleia flowers in gardens",
                    phenology: "Red admirals now overwinter in increasing numbers rather than migrating, changing from migrants to residents.",
                    species: ["red admiral butterflies"]
                },
                {
                    date: "5th September",
                    message: "Crab apples fall pink and yellow beneath ancient trees",
                    phenology: "Crab apple fruiting has advanced 8-12 days, affecting wildlife that depend on this autumn food source.",
                    species: ["crab apples"]
                },
                {
                    date: "6th September",
                    message: "Redwings call softly as they arrive from northern forests",
                    phenology: "Redwing arrival is delayed by 3-4 weeks, with some populations staying in Scandinavia through milder winters.",
                    species: ["redwings"]
                },
                {
                    date: "7th September",
                    message: "Hornets hunt insects around fallen fruit",
                    phenology: "Hornet colonies remain active 3-4 weeks longer than historically, with some surviving mild winters.",
                    species: ["hornets"]
                },
                {
                    date: "8th September",
                    message: "Pink waxcap mushrooms emerge in unimproved grasslands",
                    phenology: "Waxcap fruiting periods have become more erratic, with some species appearing earlier but others delayed.",
                    species: ["pink waxcap mushrooms"]
                },
                {
                    date: "9th September",
                    message: "Comma butterflies seek overwintering sites in ivy and brambles",
                    phenology: "Comma butterflies now produce additional broods in warm years, with some individuals active into December.",
                    species: ["comma butterflies"]
                },
                {
                    date: "10th September",
                    message: "Sloe berries bloom with blue-white waxy coating",
                    phenology: "Sloe ripening has advanced 6-8 days, sometimes occurring before traditional sloe gin making time.",
                    species: ["sloe berries"]
                },
                {
                    date: "11th September",
                    message: "Peacock butterflies gather on sedum flowers, wings brilliant in autumn sun",
                    phenology: "Peacock butterflies extend their active period by 2-3 weeks, delaying hibernation in warm autumns.",
                    species: ["peacock butterflies"]
                },
                {
                    date: "12th September",
                    message: "Field mushrooms appear overnight in sheep-grazed pastures",
                    phenology: "Mushroom fruiting has become less predictable, with traditional autumn flushes sometimes occurring in summer.",
                    species: ["field mushrooms"]
                },
                {
                    date: "13th September",
                    message: "Winter moths begin emerging for their flightless mating rituals",
                    phenology: "Winter moth emergence timing is shifting and extending, with impacts on spring bird breeding that depend on caterpillars.",
                    species: ["winter moths"]
                },
                {
                    date: "14th September",
                    message: "Beechnuts fall in their prickly cases beneath ancient trees",
                    phenology: "Beech mast years are becoming more frequent but less predictable, affecting woodland wildlife cycles.",
                    species: ["beechnuts"]
                },
                {
                    date: "15th September",
                    message: "Migrant yellow wagtails gather in stubble fields",
                    phenology: "Yellow wagtail migration timing remains stable, but populations decline due to reduced insect abundance.",
                    species: ["yellow wagtails"]
                },
                {
                    date: "16th September",
                    message: "Ivy begins its late flowering, vital for autumn insects",
                    phenology: "Ivy flowering occurs 5-7 days earlier, providing crucial late nectar but sometimes finishing before all insects need it.",
                    species: ["ivy"]
                },
                {
                    date: "17th September",
                    message: "Conkers fall glossy and brown from horse chestnut trees",
                    phenology: "Conker fall occurs 1-2 weeks earlier, but leaf-miner damage often reduces seed viability.",
                    species: ["conkers"]
                },
                {
                    date: "18th September",
                    message: "Swallows line up on rooftops, their departure imminent",
                    phenology: "Swallow departure has become more variable, with some populations leaving 1-2 weeks later than historically.",
                    species: ["swallows"]
                },
                {
                    date: "19th September",
                    message: "Rosehips glow red and orange in hedgerows and gardens",
                    phenology: "Rose hip formation occurs earlier but with more variable vitamin C content due to summer temperature stress.",
                    species: ["rosehips"]
                },
                {
                    date: "20th September",
                    message: "Meadow saffron flowers emerge from bare earth without leaves",
                    phenology: "Meadow saffron flowering has advanced 8-10 days, sometimes completing before optimal soil conditions develop.",
                    species: ["meadow saffron"]
                },
                {
                    date: "21st September",
                    message: "House spiders emerge seeking mates in autumn corners",
                    phenology: "Spider mating seasons have extended by 2-3 weeks, with activity continuing later into autumn.",
                    species: ["house spiders"]
                },
                {
                    date: "22nd September",
                    message: "Acorns ripen and fall beneath oak trees",
                    phenology: "Acorn production cycles are becoming more erratic, with climate stress affecting oak reproductive success.",
                    species: ["acorns"]
                },
                {
                    date: "23rd September",
                    message: "Brimstone butterflies seek buckthorn bushes for egg-laying",
                    phenology: "Brimstone egg-laying extends later into autumn, but larval development faces unpredictable spring timing.",
                    species: ["brimstone butterflies"]
                },
                {
                    date: "24th September",
                    message: "Robins sing territorial songs as they establish winter territories",
                    phenology: "Robin territory establishment occurs 1-2 weeks earlier, with winter singing periods extending longer.",
                    species: ["robins"]
                },
                {
                    date: "25th September",
                    message: "Haws ripen red on hawthorn branches",
                    phenology: "Hawthorn berry ripening has advanced 5-8 days, affecting birds that time migration with this food source.",
                    species: ["haws"]
                },
                {
                    date: "26th September",
                    message: "Small copper butterflies bask on sedum flowers",
                    phenology: "Small coppers now produce additional broods, with some flying into November in warm years.",
                    species: ["small copper butterflies"]
                },
                {
                    date: "27th September",
                    message: "Fieldfares strip berry bushes with their harsh calls",
                    phenology: "Fieldfare feeding behavior changes as berry ripening times shift, forcing adaptation to new food sequences.",
                    species: ["fieldfares"]
                },
                {
                    date: "28th September",
                    message: "Hornbeam leaves turn yellow-gold in ancient woodlands",
                    phenology: "Hornbeam leaf color change occurs 6-8 days later, with autumn colors less intense in warm years.",
                    species: ["hornbeam leaves"]
                },
                {
                    date: "29th September",
                    message: "Red kites soar over valleys, their numbers slowly recovering",
                    phenology: "Red kite breeding seasons extend longer, but extreme weather events during nesting affect success rates.",
                    species: ["red kites"]
                },
                {
                    date: "30th September",
                    message: "Autumn crocuses push through fallen leaves in ancient meadows",
                    phenology: "Autumn crocus flowering has become more unpredictable, with some populations flowering weeks apart.",
                    species: ["autumn crocuses"]
                },
				{
					date: "1st October",
					message: "Buzzards soar on thermals above golden stubble fields, their mewing calls echoing across the harvest landscape",
					phenology: "Buzzards are extending their breeding season later into autumn as warmer weather improves small mammal activity and hunting success.",
					species: ["buzzards"]
				},
				{
					date: "2nd October",
					message: "Sycamore leaves turn brilliant yellow, creating cathedral arches of autumn gold",
					phenology: "Sycamore leaf color change is occurring later in the season, with trees holding their leaves up to two weeks longer than historically.",
					species: ["sycamore leaves"]
				},
				{
					date: "3rd October",
					message: "Common lizards bask on sun-warmed stones, storing energy before their winter retreat",
					phenology: "Lizards are remaining active later into autumn, with some extending their active season by several weeks in warmer years.",
					species: ["common lizards"]
				},
				{
					date: "4th October",
					message: "Siskins descend in twittering flocks to feed on alder seeds beside rivers and streams",
					phenology: "Siskins are arriving later from northern breeding grounds as milder conditions delay the urge to move south for winter.",
					species: ["siskins"]
				},
				{
					date: "5th October",
					message: "Sweet chestnut cases split open, revealing glossy brown nuts that sustained medieval communities",
					phenology: "Sweet chestnuts are producing nuts earlier in the season but climate stress is affecting kernel quality and size.",
					species: ["sweet chestnuts"]
				},
				{
					date: "6th October",
					message: "Grey wagtails dance along stream edges, their yellow breasts bright against dark water",
					phenology: "Grey wagtails are remaining in upland areas longer before moving to lowland waters, as extended mild weather maintains insect populations.",
					species: ["grey wagtails"]
				},
				{
					date: "7th October",
					message: "Daddy longlegs emerge in dancing clouds from damp grassland, their gangly forms catching the evening light",
					phenology: "Crane flies are emerging later in autumn and in larger numbers, as warmer soils extend their development period.",
					species: ["daddy longlegs"]
				},
				{
					date: "8th October",
					message: "Maple leaves flame scarlet and orange, nature's bonfire lighting up parkland and hedgerows",
					phenology: "Field maple color change is becoming more variable, with some trees turning weeks earlier or later than normal seasonal patterns.",
					species: ["maple leaves"]
				},
				{
					date: "9th October",
					message: "Roe deer emerge from woodlands at dusk, their russet coats blending with bracken and fallen leaves",
					phenology: "Roe deer are changing to winter coats later in the season, as prolonged mild weather delays the trigger for coat molt.",
					species: ["roe deer"]
				},
				{
					date: "10th October",
					message: "Spindle berries split to reveal bright orange seeds, nature's Halloween decorations adorning hedgerows",
					phenology: "Spindle is fruiting earlier but seeds are lasting longer on branches, providing extended food sources for winter birds.",
					species: ["spindle berries"]
				},
				{
					date: "11th October",
					message: "Jackdaws gather in raucous assemblies on church towers, their metallic calls announcing the season's turn",
					phenology: "Jackdaws are forming winter flocks later in the year, as extended warm weather reduces the pressure to gather for communal roosting.",
					species: ["jackdaws"]
				},
				{
					date: "12th October",
					message: "Funnel-web spiders stretch their silken sheets across dewy grass, creating nature's silver carpets",
					phenology: "Sheet web spiders are remaining active later into autumn, with mild weather extending their hunting season and web-building activity.",
					species: ["funnel-web spiders"]
				},
				{
					date: "13th October",
					message: "Atlantic grey seals return to breeding beaches, their haunting calls echoing across windswept shores",
					phenology: "Grey seal pupping is starting earlier in some colonies, with mothers coming ashore up to three weeks ahead of traditional timing.",
					species: ["atlantic grey seals"]
				},
				{
					date: "14th October",
					message: "Sand martins gather in massive roosts before their journey to African wintering grounds",
					phenology: "Sand martins are delaying migration by up to two weeks, with some attempting late broods that may not survive early cold snaps.",
					species: ["sand martins"]
				},
				{
					date: "15th October",
					message: "Walnuts drop from ancient trees, their hard shells protecting treasures that sustained our ancestors",
					phenology: "Walnut trees are producing nuts earlier in the season, but unpredictable weather is affecting kernel development and oil content.",
					species: ["walnuts"]
				},
				{
					date: "16th October",
					message: "Greylag geese return from northern breeding grounds, their honking calls filling misty morning skies",
					phenology: "Greylag geese are arriving later and in smaller numbers, as warming Arctic conditions allow them to remain north for longer periods.",
					species: ["greylag geese"]
				},
				{
					date: "17th October",
					message: "Hornbeam fruits hang like paper lanterns, each seed equipped with a wing for wind dispersal",
					phenology: "Hornbeam seed production is becoming more erratic, with mast years occurring more frequently but individual seed viability declining.",
					species: ["hornbeam fruits"]
				},
				{
					date: "18th October",
					message: "Coal tits cache seeds in bark crevices, their black caps bobbing as they prepare for winter scarcity",
					phenology: "Coal tits are extending their caching behavior later into autumn, as milder weather allows continued foraging and seed availability.",
					species: ["coal tits"]
				},
				{
					date: "19th October",
					message: "Common seals gather on sandbanks during low tides, their whiskered faces tracking movement in shallow waters",
					phenology: "Common seal haul-out patterns are changing, with seals remaining active in water longer as warming seas maintain fish populations.",
					species: ["common seals"]
				},
				{
					date: "20th October",
					message: "Wolf spiders carry their egg sacs like precious cargo, preparing the next generation for spring emergence",
					phenology: "Wolf spiders are extending their reproductive season later into autumn, with some females producing second broods in warmer years.",
					species: ["wolf spiders"]
				},
				{
					date: "21st October",
					message: "Tawny owls call through lengthening nights, establishing territories in the amber glow of street lamps",
					phenology: "Tawny owls are calling later into autumn as extended mild weather supports higher small mammal populations for hunting.",
					species: ["tawny owls"]
				},
				{
					date: "22nd October",
					message: "Lime tree leaves carpet pavements in butter yellow, their heart shapes creating natural confetti",
					phenology: "Lime trees are holding leaves longer and dropping them in more concentrated periods, affecting autumn cleanup and soil nutrients.",
					species: ["lime tree leaves"]
				},
				{
					date: "23rd October",
					message: "Clouded yellow butterflies appear on southern coasts, their golden wings carrying genetics from continental Europe",
					phenology: "Clouded yellows are arriving in greater numbers and establishing temporary breeding populations further north than previously recorded.",
					species: ["clouded yellow butterflies"]
				},
				{
					date: "24th October",
					message: "Guelder rose berries glow like rubies in hedgerows, their translucent skin catching autumn's slanted light",
					phenology: "Guelder rose is fruiting earlier but berries are persisting longer on branches, extending the feeding window for thrushes and other birds.",
					species: ["guelder rose berries"]
				},
				{
					date: "25th October",
					message: "Kestrels hover over rough grassland, their wings beating against October's strengthening winds",
					phenology: "Kestrels are maintaining territories later into autumn as warmer weather keeps vole populations active in rough grass.",
					species: ["kestrels"]
				},
				{
					date: "26th October",
					message: "Birch leaves turn golden yellow before spiraling down in autumn's gentle rain",
					phenology: "Silver birch trees are experiencing delayed leaf drop, with some retaining foliage up to three weeks longer than historical averages.",
					species: ["birch leaves"]
				},
				{
					date: "27th October",
					message: "Brent geese arrive on mudflats and estuaries, their dark forms scattered across the tide line",
					phenology: "Brent geese are arriving later from Arctic breeding grounds, with peak numbers now occurring weeks later than in previous decades.",
					species: ["brent geese"]
				},
				{
					date: "28th October",
					message: "Yew berries ripen to bright red, their toxic seeds protected by sweet flesh that feeds winter thrushes",
					phenology: "Yew trees are producing berries earlier and more abundantly, but also experiencing increased stress from drought and heat waves.",
					species: ["yew berries"]
				},
				{
					date: "29th October",
					message: "Linnets gather in chattering flocks on stubble fields, their twittering calls brightening grey October days",
					phenology: "Linnets are forming winter flocks later in the season and remaining in upland areas longer as seed sources persist in milder weather.",
					species: ["linnets"]
				},
				{
					date: "30th October",
					message: "Wigeon return to flooded meadows and reservoirs, their whistling calls echoing across darkening waters",
					phenology: "Wigeon are arriving later from northern breeding areas, with peak numbers shifting later in autumn as Arctic ice forms later.",
					species: ["wigeon"]
				},
				{
					date: "31st October",
					message: "Orb weaver spiders spin their final webs before winter, dewdrops transforming silk into strings of diamonds",
					phenology: "Garden orb weavers are remaining active later into autumn, with some females surviving to November in increasingly mild years.",
					species: ["orb weaver spiders"]
				}
            ],

            speciesLinks: {
                "swallows": "https://www.rspb.org.uk/birds-and-wildlife/wildlife-guides/bird-a-z/swallow/",
                "starlings": "https://www.rspb.org.uk/birds-and-wildlife/wildlife-guides/bird-a-z/starling/",
                "house martins": "https://www.rspb.org.uk/birds-and-wildlife/wildlife-guides/bird-a-z/house-martin/",
                "fieldfares": "https://www.rspb.org.uk/birds-and-wildlife/wildlife-guides/bird-a-z/fieldfare/",
                "redwings": "https://www.rspb.org.uk/birds-and-wildlife/wildlife-guides/bird-a-z/redwing/",
                "yellow wagtails": "https://www.rspb.org.uk/birds-and-wildlife/wildlife-guides/bird-a-z/yellow-wagtail/",
                "robins": "https://www.rspb.org.uk/birds-and-wildlife/wildlife-guides/bird-a-z/robin/",
                "red kites": "https://www.rspb.org.uk/birds-and-wildlife/wildlife-guides/bird-a-z/red-kite/",
                "common darters": "https://www.wildlifetrusts.org/wildlife-explorer/invertebrates/dragonflies/common-darter",
                "migrant hawker dragonflies": "https://www.wildlifetrusts.org/wildlife-explorer/invertebrates/dragonflies/migrant-hawker",
                "painted lady butterflies": "https://www.wildlifetrusts.org/wildlife-explorer/invertebrates/butterflies-and-moths/painted-lady",
                "speckled wood butterflies": "https://www.wildlifetrusts.org/wildlife-explorer/invertebrates/butterflies-and-moths/speckled-wood",
                "red admiral butterflies": "https://www.wildlifetrusts.org/wildlife-explorer/invertebrates/butterflies-and-moths/red-admiral",
                "comma butterflies": "https://www.wildlifetrusts.org/wildlife-explorer/invertebrates/butterflies-and-moths/comma",
                "peacock butterflies": "https://www.wildlifetrusts.org/wildlife-explorer/invertebrates/butterflies-and-moths/peacock",
                "winter moths": "https://www.wildlifetrusts.org/wildlife-explorer/invertebrates/moths/winter-moth",
                "brimstone butterflies": "https://www.wildlifetrusts.org/wildlife-explorer/invertebrates/butterflies-and-moths/brimstone",
                "small copper butterflies": "https://www.wildlifetrusts.org/wildlife-explorer/invertebrates/butterflies-and-moths/small-copper",
                "hornets": "https://www.wildlifetrusts.org/wildlife-explorer/invertebrates/bees-wasps-and-ants/hornet",
                "house spiders": "https://www.wildlifetrusts.org/wildlife-explorer/invertebrates/spiders/giant-house-spider",
                "blackberries": "https://www.woodlandtrust.org.uk/trees-woods-and-wildlife/plants/wild-flowers/bramble/",
                "rowan berries": "https://www.wildlifetrusts.org/wildlife-explorer/trees-and-shrubs/rowan",
                "wild clematis": "https://www.woodlandtrust.org.uk/trees-woods-and-wildlife/plants/wild-flowers/travellers-joy/",
                "hazel nuts": "https://www.wildlifetrusts.org/wildlife-explorer/trees-and-shrubs/hazel",
                "elderberries": "https://www.wildlifetrusts.org/wildlife-explorer/trees-and-shrubs/elder",
                "crab apples": "https://www.wildlifetrusts.org/wildlife-explorer/trees-and-shrubs/crab-apple",
                "sloe berries": "https://www.wildlifetrusts.org/wildlife-explorer/trees-and-shrubs/blackthorn",
                "beechnuts": "https://www.wildlifetrusts.org/wildlife-explorer/trees-and-shrubs/common-beech",
                "ivy": "https://www.wildlifetrusts.org/wildlife-explorer/trees-and-shrubs/ivy",
                "conkers": "https://www.wildlifetrusts.org/wildlife-explorer/trees-and-shrubs/horse-chestnut",
                "rosehips": "https://www.wildlifetrusts.org/wildlife-explorer/trees-and-shrubs/dog-rose",
                "meadow saffron": "https://www.wildlifetrusts.org/wildlife-explorer/wildflowers/meadow-saffron",
                "acorns": "https://www.wildlifetrusts.org/wildlife-explorer/trees-and-shrubs/english-oak",
                "haws": "https://www.woodlandtrust.org.uk/trees-woods-and-wildlife/british-trees/a-z-of-british-trees/hawthorn/",
                "hornbeam leaves": "https://www.wildlifetrusts.org/wildlife-explorer/trees-and-shrubs/common-hornbeam",
                "autumn crocuses": "https://www.wildlifetrusts.org/wildlife-explorer/wildflowers/meadow-saffron",
                "pink waxcap mushrooms": "https://www.wildlifetrusts.org/wildlife-explorer/fungi/pink-waxcap",
                "field mushrooms": "https://totallywilduk.co.uk/2022/01/17/field-mushroom-agaricus-campestris-identification/"
            }
        };

        // ==========================================================================
        // APPLICATION CODE - You usually won't need to edit below this line
        // ==========================================================================

        let currentMessageIndex = 0;
        let touchStartX = 0;
        let touchEndX = 0;
        let isLoading = true;

        function createLinkedMessage(message, speciesInMessage) {
            let linkedMessage = message;
            
            if (speciesInMessage && Array.isArray(speciesInMessage)) {
                speciesInMessage.forEach(species => {
                    const link = NATURE_DATA.speciesLinks[species];
                    if (link) {
                        const regex = new RegExp(`\\b${species}\\b`, 'gi');
                        linkedMessage = linkedMessage.replace(regex, (match, offset) => {
                            const isStartOfSentence = offset === 0 || linkedMessage.substring(offset - 2, offset) === '. ';
                            const displayText = isStartOfSentence ? 
                                match.charAt(0).toUpperCase() + match.slice(1).toLowerCase() : 
                                match.toLowerCase();
                            
                            return `<a href="${link}" target="_blank" rel="noopener noreferrer">${displayText}</a>`;
                        });
                    }
                });
            }
            
            return linkedMessage;
        }

        function showMessage(index) {
            if (!NATURE_DATA.messages[index]) return;
            
            const message = NATURE_DATA.messages[index];
            
            // Remove loading class
            document.getElementById('dailyMessage').classList.remove('loading');
            document.getElementById('phenologyInfo').classList.remove('loading');
            
            document.getElementById('currentDate').textContent = message.date;
            
            // Create message with species links
            const messageElement = document.getElementById('dailyMessage');
            const linkedMessage = createLinkedMessage(message.message, message.species);
            messageElement.innerHTML = linkedMessage;
            
            // Show phenology information
            document.getElementById('phenologyInfo').innerHTML = 
                `<span class="phenology-label">Impacts of a warming climate</span>${message.phenology}`;
            
            // Update navigation buttons
            document.getElementById('prevBtn').disabled = false;
            document.getElementById('nextBtn').disabled = false;
            
            isLoading = false;
        }

        function nextMessage() {
            if (isLoading) return;
            currentMessageIndex = (currentMessageIndex + 1) % NATURE_DATA.messages.length;
            showMessage(currentMessageIndex);
        }

        function previousMessage() {
            if (isLoading) return;
            currentMessageIndex = (currentMessageIndex - 1 + NATURE_DATA.messages.length) % NATURE_DATA.messages.length;
            showMessage(currentMessageIndex);
        }

        // Touch/Swipe functionality
        function handleTouchStart(event) {
            if (isLoading) return;
            touchStartX = event.touches[0].clientX;
        }

        function handleTouchMove(event) {
            if (isLoading) return;
            event.preventDefault();
        }

        function handleTouchEnd(event) {
            if (isLoading) return;
            touchEndX = event.changedTouches[0].clientX;
            handleSwipe();
        }

        function handleSwipe() {
            const swipeThreshold = 50;
            const swipeDistance = touchEndX - touchStartX;

            if (Math.abs(swipeDistance) > swipeThreshold) {
                if (swipeDistance > 0) {
                    previousMessage();
                } else {
                    nextMessage();
                }
            }
        }

        // Keyboard navigation
        function handleKeyPress(event) {
            if (isLoading) return;
            if (event.key === 'ArrowLeft') {
                previousMessage();
            } else if (event.key === 'ArrowRight') {
                nextMessage();
            }
        }

        function initializeApp() {
            try {
                // Start with August 22nd (index 0)
                currentMessageIndex = 0;
                
                // Add event listeners
                const container = document.getElementById('mainContainer');
                if (container) {
                    container.addEventListener('touchstart', handleTouchStart, { passive: false });
                    container.addEventListener('touchmove', handleTouchMove, { passive: false });
                    container.addEventListener('touchend', handleTouchEnd, { passive: false });
                }
                
                // Add keyboard navigation
                document.addEventListener('keydown', handleKeyPress);
                
                // Show initial message with a slight delay for better UX
                setTimeout(() => {
                    showMessage(currentMessageIndex);
                }, 100);
                
            } catch (error) {
                console.error('Error initializing app:', error);
                document.getElementById('dailyMessage').textContent = 'Error loading content. Please refresh the page.';
                document.getElementById('phenologyInfo').textContent = '';
            }
        }

        // Initialize when DOM is ready
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', initializeApp);
        } else {
            initializeApp();
        }
    </script>
</body>
</html>
