<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Naturenow</title>
    
    <!-- PWA Meta Tags -->
    <meta name="description" content="Daily messages about the natural world and climate change impacts">
    <meta name="theme-color" content="#667eea">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="Nature Daily">
    
    <!-- PWA Icons -->
    <link rel="icon" type="image/png" sizes="192x192" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><circle cx='50' cy='50' r='40' fill='%23667eea'/><text x='50%' y='50%' text-anchor='middle' dy='0.3em' font-size='40'>üåø</text></svg>">
    <link rel="icon" type="image/png" sizes="512x512" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><circle cx='50' cy='50' r='40' fill='%23667eea'/><text x='50%' y='50%' text-anchor='middle' dy='0.3em' font-size='40'>üåø</text></svg>">
    <link rel="apple-touch-icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><circle cx='50' cy='50' r='40' fill='%23667eea'/><text x='50%' y='50%' text-anchor='middle' dy='0.3em' font-size='40'>üåø</text></svg>">
    
    <!-- PWA Manifest -->
    <link rel="manifest" href="manifest.json">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Georgia', serif;
            background: #f8f9fa;
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #333;
            line-height: 1.6;
        }

        .container {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 40px;
            max-width: 600px;
            margin: 20px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            backdrop-filter: blur(10px);
            text-align: center;
            transition: transform 0.3s ease;
            position: relative;
            overflow: hidden;
            touch-action: pan-y;
        }

        .container:hover {
            transform: translateY(-5px);
        }

        .swipe-hint {
            position: absolute;
            top: 10px;
            right: 15px;
            font-size: 12px;
            color: #999;
            opacity: 0.7;
        }

        .learn-more {
            display: inline-block;
            margin-top: 15px;
            padding: 8px 16px;
            background: rgba(52, 152, 219, 0.1);
            color: #2980b9;
            text-decoration: none;
            border-radius: 15px;
            font-size: 14px;
            border: 1px solid rgba(52, 152, 219, 0.3);
            transition: all 0.3s ease;
        }

        .learn-more:hover {
            background: rgba(52, 152, 219, 0.2);
            transform: translateY(-1px);
        }

        .date {
            font-size: 18px;
            color: #666;
            margin-bottom: 30px;
            font-weight: 300;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .message {
            font-size: 24px;
            color: #2c3e50;
            margin-bottom: 20px;
            font-weight: 400;
            animation: fadeIn 1s ease-in;
        }

        .phenology-info {
            font-size: 16px;
            color: #7f8c8d;
            background: rgba(52, 152, 219, 0.1);
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 30px;
            border-left: 4px solid #3498db;
            animation: slideIn 1s ease-in 0.3s both;
        }

        .phenology-label {
            font-weight: 600;
            color: #2980b9;
            display: block;
            margin-bottom: 5px;
            font-size: 14px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .nature-icon {
            font-size: 60px;
            margin-bottom: 20px;
            animation: pulse 2s infinite;
        }

        .refresh-btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 12px 30px;
            border-radius: 25px;
            font-size: 16px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-family: inherit;
        }

        .refresh-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.2);
        }

        @media (max-width: 480px) {
            .container {
                padding: 30px 20px;
                margin: 10px;
            }
            
        @media (max-width: 480px) {
            .container {
                padding: 30px 20px;
                margin: 10px;
            }
            
            .message {
                font-size: 20px;
            }
        }
    </style>
</head>
<body>
    <div class="container" id="mainContainer">
        <div class="swipe-hint">Swipe ‚Üê ‚Üí</div>
        <div class="date" id="currentDate"></div>
        <div class="message" id="dailyMessage">Loading your daily nature message...</div>
        <div class="phenology-info" id="phenologyInfo">
            <span class="phenology-label">Impacts of a changing climate</span>
            Loading phenology information...
        </div>
    </div>

    <script>
        const natureMessages = [
            {
                date: "1st May",
                message: "Female cuckoos are arriving",
                phenology: "Cuckoos now arrive 5-7 days earlier than in the 1960s, but their host species' breeding timing hasn't shifted equally.",
                icon: "üê¶",
                link: "https://www.rspb.org.uk/birds-and-wildlife/wildlife-guides/bird-a-z/cuckoo/",
                linkText: "cuckoos"
            },
            {
                date: "2nd May",
                message: "The first nightjars arrive, churring and wing clapping at dusk",
                phenology: "Nightjars arrive 8-10 days earlier than historical records, but their insect prey peaks haven't shifted as much.",
                icon: "üåô",
                link: "https://www.rspb.org.uk/birds-and-wildlife/wildlife-guides/bird-a-z/nightjar/",
                linkText: "nightjars"
            },
            {
                date: "3rd May",
                message: "Wild bluebells are in full flower in the woods",
                phenology: "Bluebells now flower 2-3 weeks earlier than in the 1950s, shortening their blooming period and affecting woodland ecology.",
                icon: "üå∏",
                link: "https://www.woodlandtrust.org.uk/trees-woods-and-wildlife/plants/wild-flowers/bluebell/",
                linkText: "bluebells"
            },
            {
                date: "4th May",
                message: "Young tawny owls may be calling now, before they have broken out of their egg",
                phenology: "Tawny owl breeding is advancing by 4-5 days per decade, but their rodent prey availability timing is shifting differently.",
                icon: "ü¶â",
                link: "https://www.rspb.org.uk/birds-and-wildlife/wildlife-guides/bird-a-z/tawny-owl/",
                linkText: "tawny owls"
            },
            {
                date: "5th May",
                message: "The first young grebes have hatched and are carried on the backs of their parents",
                phenology: "Great crested grebes breed 6-8 days earlier than in the 1970s, but warmer waters affect their fish food availability.",
                icon: "üê£",
                link: "https://www.rspb.org.uk/birds-and-wildlife/wildlife-guides/bird-a-z/great-crested-grebe/",
                linkText: "grebes"
            },
            {
                date: "6th May",
                message: "Spotted flycatchers are arriving from Africa",
                phenology: "Spotted flycatchers arrive 3-4 days earlier than in the 1960s, but their aerial insect prey peaks are shifting unpredictably.",
                icon: "üê¶",
                link: "https://www.rspb.org.uk/birds-and-wildlife/wildlife-guides/bird-a-z/spotted-flycatcher/",
                linkText: "Spotted flycatchers"
            },
            {
                date: "7th May",
                message: "The rare golden orieole's fluting sound may be heard",
                phenology: "Golden orioles arrive 7-9 days earlier than historical records, but habitat loss compounds timing disruption challenges.",
                icon: "üéµ",
                link: "https://www.rspb.org.uk/birds-and-wildlife/wildlife-guides/bird-a-z/golden-oriole/",
                linkText: "golden orieole"
            },
            {
                date: "8th May",
                message: "Oaks are in flower, producing a lot of pollen",
                phenology: "Oak flowering advances 2-3 days per decade, extending pollen seasons and affecting both wildlife and human allergies.",
                icon: "üå≥",
                link: "https://www.woodlandtrust.org.uk/trees-woods-and-wildlife/british-trees/a-z-of-british-trees/english-oak/",
                linkText: "Oaks"
            },
            {
                date: "9th May",
                message: "Holly blue butterfiles are on the wing",
                phenology: "Holly blues emerge 8-12 days earlier than in the 1980s, risking mismatch with their host plants' optimal timing.",
                icon: "ü¶ã",
                link: "https://butterfly-conservation.org/butterflies/holly-blue",
                linkText: "Holly blue butterfiles"
            },
            {
                date: "10th May",
                message: "The last of the summer migrants have arrived : swifts are screaming across the sky",
                phenology: "Swifts arrive 4-6 days earlier than in the 1960s, but their aerial insect food may not be at peak abundance yet.",
                icon: "üê¶",
                link: "https://www.rspb.org.uk/birds-and-wildlife/wildlife-guides/bird-a-z/swift/",
                linkText: "swifts"
            }
        ];

        let currentMessageIndex = 0;
        let touchStartX = 0;
        let touchEndX = 0;

        function formatDate(date = new Date()) {
            const day = date.getDate();
            const month = date.toLocaleDateString('en-US', { month: 'long' });
            
            // Add ordinal suffix (st, nd, rd, th)
            const getOrdinalSuffix = (day) => {
                if (day > 3 && day < 21) return 'th';
                switch (day % 10) {
                    case 1: return 'st';
                    case 2: return 'nd';
                    case 3: return 'rd';
                    default: return 'th';
                }
            };
            
            return `${day}${getOrdinalSuffix(day)} ${month}`;
        }

        function getCurrentMessage() {
            return natureMessages[currentMessageIndex];
        }

        function showMessage(index) {
            const message = natureMessages[index];
            document.getElementById('currentDate').textContent = message.date;
            
            // Create message with linked text
            const messageElement = document.getElementById('dailyMessage');
            const messageText = message.message;
            const linkText = message.linkText;
            
            if (linkText && messageText.includes(linkText)) {
                const linkedMessage = messageText.replace(
                    linkText, 
                    `<a href="${message.link}" target="_blank" style="color: #2980b9; text-decoration: underline;">${linkText}</a>`
                );
                messageElement.innerHTML = linkedMessage;
            } else {
                messageElement.textContent = messageText;
            }
            
            document.getElementById('phenologyInfo').innerHTML = 
                `<span class="phenology-label">Impacts of a changing climate</span>${message.phenology}`;
        }

        function nextMessage() {
            currentMessageIndex = (currentMessageIndex + 1) % natureMessages.length;
            showMessage(currentMessageIndex);
        }

        function previousMessage() {
            currentMessageIndex = (currentMessageIndex - 1 + natureMessages.length) % natureMessages.length;
            showMessage(currentMessageIndex);
        }

        // Touch/Swipe functionality
        function handleTouchStart(event) {
            touchStartX = event.touches[0].clientX;
        }

        function handleTouchMove(event) {
            event.preventDefault(); // Prevent scrolling
        }

        function handleTouchEnd(event) {
            touchEndX = event.changedTouches[0].clientX;
            handleSwipe();
        }

        function handleSwipe() {
            const swipeThreshold = 50;
            const swipeDistance = touchEndX - touchStartX;

            if (Math.abs(swipeDistance) > swipeThreshold) {
                if (swipeDistance > 0) {
                    // Swipe right - go to previous day
                    previousMessage();
                } else {
                    // Swipe left - go to next day
                    nextMessage();
                }
            }
        }

        // Keyboard navigation
        function handleKeyPress(event) {
            if (event.key === 'ArrowLeft') {
                previousMessage();
            } else if (event.key === 'ArrowRight') {
                nextMessage();
            }
        }

        function initializeApp() {
            // Start with May 1st (index 0)
            currentMessageIndex = 0;
            showMessage(currentMessageIndex);
            
            // Add touch event listeners
            const container = document.getElementById('mainContainer');
            container.addEventListener('touchstart', handleTouchStart, { passive: false });
            container.addEventListener('touchmove', handleTouchMove, { passive: false });
            container.addEventListener('touchend', handleTouchEnd, { passive: false });
            
            // Add keyboard navigation
            document.addEventListener('keydown', handleKeyPress);
        }

        // Initialize the app when the page loads
        initializeApp();

        // Register Service Worker for PWA
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', function() {
                navigator.serviceWorker.register('sw.js')
                    .then(function(registration) {
                        console.log('ServiceWorker registration successful');
                    })
                    .catch(function(err) {
                        console.log('ServiceWorker registration failed: ', err);
                    });
            });
        }
    </script>
</body>
</html>
